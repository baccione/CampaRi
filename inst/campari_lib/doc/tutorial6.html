<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
############################################################################
# LICENSE INFO:                                                            #
############################################################################
#    This file is part of CAMPARI.                                         #
#                                                                          #
#    Version 2.0                                                           #
#                                                                          #
#    Copyright (C) 2014, The CAMPARI development team (current and former  #
#                        contributors)                                     #
#                        Andreas Vitalis, Adam Steffen, Rohit Pappu, Hoang #
#                        Tran, Albert Mao, Xiaoling Wang, Jose Pulido,     #
#                        Nicholas Lyle, Nicolas Bloechliger                #
#                                                                          #
#    Website: http://sourceforge.net/projects/campari/                     #
#                                                                          #
#    CAMPARI is free software: you can redistribute it and/or modify       #
#    it under the terms of the GNU General Public License as published by  #
#    the Free Software Foundation, either version 3 of the License, or     #
#    (at your option) any later version.                                   #
#                                                                          #
#    CAMPARI is distributed in the hope that it will be useful,            #
#    but WITHOUT ANY WARRANTY; without even the implied warranty of        #
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         #
#    GNU General Public License for more details.                          #
#                                                                          #
#    You should have received a copy of the GNU General Public License     #
#    along with CAMPARI.  If not, see <http://www.gnu.org/licenses/>.      #
############################################################################
# AUTHORSHIP INFO:                                                         #
############################################################################
#                                                                          #
# MAIN AUTHOR:   Andreas Vitalis                                           #
# CONTRIBUTIONS: Adam Steffen                                              #
#                                                                          #
############################################################################
-->
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US" xml:lang="en">
<head>
    <!--
    Designed by CAMPARI Development Group
    Base template (without user's data) checked by http://validator.w3.org : "This page is valid XHTML 1.0 Transitional"
    -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"></meta>
    <title>CAMPARI Tutorial 6</title>
    <link rel="stylesheet" href="style_red.css" type="text/css" media="screen"></link>
</head>
<body>
<div id="art-page-background-simple-gradient"></div>
<div id="art-main">
    <!-- Header -->
    <div class="art-Sheet2">
        
        <!-- Banner Art -->
        <div class="art-Header">
            <div class="art-Header-png"></div>
        </div>
                
        <!-- Top Navigation Bar -->
        <div class="art-nav">
            <div class="l"></div>
            <div class="r"></div>
            <ul class="art-menu">
                <li><a href="index.html"><span class="l"></span><span class="r"></span><span class="t">Home</span></a></li>
                <li><a href="documentation.html" class=" active"><span class="l"></span><span class="r"></span><span class="t">Documentation</span></a></li>
                <li><a href="references.html"><span class="l"></span><span class="r"></span><span class="t">References</span></a></li>
                <li><a href="contact.html"><span class="l"></span><span class="r"></span><span class="t">Support</span></a></li>
                <li><a href="download.html"><span class="l"></span><span class="r"></span><span class="t">Download</span></a></li>
            </ul>
        </div>
            
        <!-- Top Sub Navigation Bar -->
        <div class="nav-menu">
            <ul class="navlist">
                <li><a href="documentation.html">Overview</a></li>
                <li><a href="install.html">Install</a></li>
                <li><a href="tutorials.html" class=" active">Tutorials</a></li>
                <li><a href="inputfiles.html">Inputfiles</a></li>
                <li><a href="keywords.html">Keywords</a></li>
                <li><a href="outputfiles.html">Outputfiles</a></li>
                <li><a href="parameters.html">Parameters</a></li>
                <li><a href="development.html">Development</a></li>
                <li></li>
            </ul>
        </div> 
    </div>
        
    <!-- Main Page Contents -->
    <div class="art-Sheet">
        <div class="art-Sheet-bl"></div>
        <div class="art-Sheet-br"></div>
        <div class="art-Sheet-bc"></div>
        <div class="art-Sheet-cl"></div>
        <div class="art-Sheet-cr"></div>
        <div class="art-Sheet-cc"></div>
        <div class="art-Sheet-body">
            
            <div class="art-contentLayout">
                <!-- Page Contents -->
                <div class="art-content">
                <div class="art-Post">
                <div class="art-Post-body">
<div class="art-PostContent">
<br/>
<h2>Tutorial 6: Introduction to Polynucleotides - Setting up and Running a Complex Simulation in CAMPARI</h2>
<h3>Preface:</h3>
In this tutorial we expand upon the simple monomer simulation and look at
systems with multiple molecules and high charge content. CAMPARI 
provides wide support for simulating polynucleotides, and our task here
will be to set up a simulation of a piece of double-stranded DNA (<i>i.e.,</i> two chains)
in a solvent composed of appropriate counterions, and an aqueous solution of a background electrolyte.
Such a system is not suitable for simulation by Monte Carlo methods, and we will
expand the basic control obtained in the previous tutorial over using
molecular dynamics within CAMPARI. We want to simulate a folded form of DNA,
and therefore this tutorial will also require the use of a starting structure.<br/>
The tutorial in itself does not attempt to compute any ensemble averages that
can be compared against other simulation or experimental data. It is therefore
a purely technical tutorial whose outcome will consist in nothing but a stable
simulation that can be visualized by appropriate visualization software such as
<a href="references.html#ref23_9">VMD</a>.<br/>
<br/>
<h3>Step-by-Step:</h3>
<big style="font-style: italic; text-decoration: underline;">Step 1 - Create a pdb-file of folded DNA in CAMPARI naming convention</big><br/>
<br/>
In the examples directory, we have the <a href="../examples/tutorial6/tutorial6.pdb">pdb-file</a> of the Dickerson dodecamer.
This structure was determined around 1980 by Dickerson and colleagues (<a href="references.html#ref2_8">reference</a>)
by X-ray crystallography, and it therefore does not resolve positions of hydrogen atoms.
We need to rebuild those as follows:<br/>
<br/>
<tt>
<a href="keywords.html#PARAMETERS">PARAMETERS</a> &lt;full path to CAMPARI directory&gt;/params/amber03.prm<br/>
<a href="keywords.html#SEQFILE">FMCSC_SEQFILE</a> &lt;full path to CAMPARI directory&gt;/examples/tutorial6/tutorial6.seq1<br/>
<a href="keywords.html#BASENAME">FMCSC_BASENAME</a> PREP<br/>
<a href="keywords.html#PDB_READMODE">FMCSC_PDB_READMODE</a> 2<br/>
<a href="keywords.html#PDBANALYZE">FMCSC_PDBANALYZE</a> 1<br/>
<a href="keywords.html#PDB_HMODE">FMCSC_PDB_HMODE</a> 2<br/>
<a href="keywords.html#PDB_R_CONV">FMCSC_PDB_R_CONV</a> 4<br/>
<a href="keywords.html#PDBFILE">FMCSC_PDBFILE</a> &lt;full path to CAMPARI directory&gt;/examples/tutorial6/tutorial6.pdb<br/>
<a href="keywords.html#SC_IPP">FMCSC_SC_IPP</a> 0.0<br/>
</tt>
<br/>
Note that the choice of parameter file is more or less arbitrary at this stage.
Through use of <a href="keywords.html#PDB_R_CONV">FMCSC_PDB_R_CONV</a>, we instruct CAMPARI to interpret the input pdb as a file written in AMBER-convention
so that we have to make no modifications whatsoever (related to residue naming).
The simple <a href="../examples/tutorial6/tutorial6.seq1">sequence file</a> is prepared in such a 
way that the sequence matches the Dickerson dodecamer sequence. Have a look at the file - by
now this should have been very easy to create on your own. The above keywords instruct CAMPARI to
run a "trajectory analysis" on this pdb-file which contains only a single snapshot.
Correspondingly, we set:<br/>
<br/>
<tt>
<a href="keywords.html#NRSTEPS">FMCSC_NRSTEPS</a> 1<br/>
<a href="keywords.html#EQUIL">FMCSC_EQUIL</a> 500000<br/>
</tt>
<br/>
Create an empty directory, switch to it, and paste the above keywords into a file called prep.key and proceed to run:<br/>
<br/>
<tt>
campari -k prep.key &gt;&amp; log1<br/>
</tt>
<br/>
This should take less than a second. Output will be very limited but should contain
the file "PREP_END.pdb" which is the pdb-file of the Dickerson dodecamer with added hydrogens 
and in CAMPARI naming convention. You may wonder what information CAMPARI used to build
the hydrogens into the structure. Essentially, CAMPARI differs fundamentally from other simulation
software in that it maintains an internal knowledge of molecular topology for the systems it supports.
For biomolecules, these are mostly derived from high-resolution crystallographic databases coupled
to chemical knowledge and/or implied parameters from other force fields. In this particular case,
this paradigm is advantageous.<br/>
Rename the file PREP_END.pdb to dna.pdb before proceeding to the next step.<br/>
<br/><big style="font-style: italic; text-decoration: underline;">Step 2 - Create a pdb-file of a partially randomized system</big><br/>
<br/>
With the converted pdb-file of the piece of DNA in hand, we will now, in a single step, generate 
a snapshot of the actual system of interest (including solvent and ions). For this purpose, modify existing entries in prep.key as follows:<br/>
<br/>
<tt>
<a href="keywords.html#SEQFILE">FMCSC_SEQFILE</a> &lt;full path to CAMPARI directory&gt;/examples/tutorial6/tutorial6.seq<br/>
<a href="keywords.html#PDBANALYZE">FMCSC_PDBANALYZE</a> 0<br/>
<a href="keywords.html#PDBFILE">FMCSC_PDBFILE</a> dna.pdb<br/>
<a href="keywords.html#NRSTEPS">FMCSC_NRSTEPS</a> 100000<br/>
<a href="keywords.html#PDB_R_CONV">FMCSC_PDB_R_CONV</a> 1<br/>
<a href="keywords.html#PDB_HMODE">FMCSC_PDB_HMODE</a> 1<br/>
<a href="keywords.html#SC_IPP">FMCSC_SC_IPP</a> 1.0<br/>
</tt>
<br/>
As you can see, we ask for a sequence containing all water molecules and ions, but we use a pdb-file that only
contains the two polymer chains. In such a case (sequence input starts with the entities represented in the 
structural input file, <i>i.e.</i>, "dna.pdb"), CAMPARI can automatically generate random starting positions
for all the missing species. This sometimes works even for missing parts of a polymer (see <a href="keywords.html#RANDOMIZE">FMCSC_RANDOMIZE</a>
for details). For clarity, we add:<br/>
<br/>
<tt>
<a href="keywords.html#RANDOMIZE">FMCSC_RANDOMIZE</a> 0<br/>
</tt>
<br/>
This ensures that the DNA is left intact.
For a condensed phase system, we need to of course worry about the physical dimensions and boundary
conditions for our simulation cell. The full <a href="../examples/tutorial6/tutorial6.seq">sequence file</a> 
contains 6700 water molecules, 87 sodium ions, 65 chloride ions, and the two DNA chains constituting 
a background electrolyte concentration of 0.5M and an overall density of approximately
1.02g&#183;cm<sup>-3</sup> if we stipulate a cubic box of 60&#8491; side length. This box is 
certainly too small to study counterion effects around a piece of DNA with appreciable accuracy,
but the smaller size helps making this tutorial tractable. Append "prep.key" by:<br/>
<br/>
<tt>
<a href="keywords.html#BOUNDARY">FMCSC_BOUNDARY</a> 1<br/>
<a href="keywords.html#SHAPE">FMCSC_SHAPE</a> 1<br/>
<a href="keywords.html#SIZE">FMCSC_SIZE</a> 60.0 60.0 60.0<br/>
<a href="keywords.html#TEMP">FMCSC_TEMP</a> 300.0<br/>
</tt>
<br/>
Periodic boundary conditions as chosen here are by far the most common choice for simulations
employing explicit solvent since they are thought to minimize boundary artifacts.<br/>
Thus far, we have not specified an interaction model, but note that <a href="keywords.html#SC_IPP">excluded volume interactions</a>
are turned on by default. Given the setting for <a href="keywords.html#NRSTEPS">FMCSC_NRSTEPS</a>
above, we obviously plan to perform some sort of preliminary simulation. To be specific,
we wish to use Monte Carlo sampling in rigid-body space to create a random mixture
of water and ions without too many steric clashes. Most molecular simulation packages will typically have a protocol
to use preexisting water boxes to "soak" a macromolecule. Instead, here we will use CAMPARI to 
create our own custom system completely from scratch. This has its advantages as it
is a general strategy that can be used for any solvent (including solvent mixtures of arbitrary
complexity). To make sure that this preliminary Monte Carlo run proceeds at appreciable pace,
add the following lines:<br/>
<br/>
<tt>
<a href="keywords.html#CUTOFFMODE">FMCSC_CUTOFFMODE</a> 3<br/>
<a href="keywords.html#NBCUTOFF">FMCSC_NBCUTOFF</a> 10.0<br/>
<a href="keywords.html#GRIDDIM">FMCSC_GRIDDIM</a> 10 10 10<br/>
<a href="keywords.html#GRIDMAXGPNB">FMCSC_GRIDMAXGPNB</a> 1024<br/>
<a href="keywords.html#N2LOOP">FMCSC_N2LOOP</a> 0<br/>
<a href="keywords.html#CHECKFREQ">FMCSC_CHECKFREQ</a> 10000000<br/>

</tt>
<br/>
Here, we instruct CAMPARI to use grid-based interaction cutoffs which is common practice
in most modern simulation software. We should also provide details of the move set
so that it is better-suited to our task than the default settings:<br/>
<br/>
<tt>
<a href="keywords.html#RIGIDFREQ">FMCSC_RIGIDFREQ</a> 1.0<br/>
<a href="keywords.html#RIGIDRDFREQ">FMCSC_RIGIDRDFREQ</a> 0.1<br/>
<a href="keywords.html#TRANSSTEPSZ">FMCSC_TRANSSTEPSZ</a> 0.3<br/>
<a href="keywords.html#ROTSTEPSZ">FMCSC_ROTSTEPSZ</a> 10.0<br/>
<a href="keywords.html#FRZREPORT">FMCSC_FRZREPORT</a> 1<br/>
<a href="keywords.html#FRZFILE">FMCSC_FRZFILE</a> &lt;full path to CAMPARI directory&gt;/examples/tutorial6/tutorial6.frz<br/>
</tt>
<br/>
The MC move set is focused entirely on rigid-body motion. The step sizes are suitably small
for a condensed phase system. In addition, we constrain the positions of 
the two DNA chains to prevent changes in their relative orientation from happening.
 The <a href="../examples/tutorial6/tutorial6.frz">input file</a>
is very simple and its format is explained <a href="inputfiles.html#FMCSC_FRZFILE">elsewhere</a>.
We can now run CAMPARI again as follows:<br/>
<br/>
<tt>
campari -k prep.key &gt;&amp; log2<br/>
</tt>
<br/>
This should not take more than a few minutes. Again, we obtain a pdb-file called
"PREP_END.pdb" that you should rename to "MCsoaked.pdb".<br/>
<br/><big style="font-style: italic; text-decoration: underline;">Step 3 - Create the minimized pdb-file to start production simulations from</big><br/>
<br/>
We wish to repeat the calculation just performed, just for a longer duration, and with the
DNA build in the correct duplex B-DNA conformation. To do this, replace
the section pertaining to DNA in "random.pdb" with the corresponding 
data from "dna.pdb" and call the resultant file "system.pdb". Then, edit prep.key by replacing
values for the following entries:<br/>
<br/>
<tt>
<a href="keywords.html#NRSTEPS">FMCSC_NRSTEPS</a> 499999<br/>
<a href="keywords.html#PDB_HMODE">FMCSC_PDB_HMODE</a> 1<br/>
<a href="keywords.html#PDB_R_CONV">FMCSC_PDB_R_CONV</a> 1<br/>
</tt>
<br/>

For the actual simulation and the prior "minimization", we will use a standard molecular dynamics
protocol in Cartesian space using a thermostat to obtain the canonical (NVT) ensemble. This means
that you should remove the lines requesting explicit constraints on the DNA from prep.key (see above).
After that, append the key-file by:<br/>
<br/>
<tt>
<a href="keywords.html#ENSEMBLE">FMCSC_ENSEMBLE</a> 1<br/>
<a href="keywords.html#DYNAMICS">FMCSC_DYNAMICS</a> 2<br/>
<a href="keywords.html#TSTAT">FMCSC_TSTAT</a> 4<br/>
<a href="keywords.html#CARTINT">FMCSC_CARTINT</a> 2<br/>
</tt>
<br/>
The thermostat used throughout the rest of this tutorial is the <a href="keywords.html#TSTAT">
velocity-rescaling thermostat</a> of <a href="references.html#ref12_3">Bussi <i>et al.</i></a>. We also wish to impose constant
bond lengths for all bonds for the DNA as holonomic constraints. In addition, the water model we use (TIP3P) 
is parameterized as a rigid model which means that one additional constraint per molecule is needed.
In theory, we could use option 6 for keyword <a href="keywords.html#SHAKESET">FMCSC_SHAKESET</a>
to provide <a href="inputfiles.html#FMCSC_SHAKEFILE">an exact list</a> of the constraints we want.
If written properly, such a list would be parsed by CAMPARI, and during execution the coupled constraints on the DNA
molecules would be addressed by our choice of constraint solver whereas the ones on water would
be solved analytically by the so-called SETTLE (<a href="references.html#ref5_10">reference</a>) procedure
(CAMPARI will do this for all suitable
constraint groups). Since such a list may be inconvenient to prepare, we use the following syntax:<br/>
<br/>
<tt>
<a href="keywords.html#SHAKEMETHOD">FMCSC_SHAKEMETHOD</a> 1<br/>
<a href="keywords.html#SHAKESET">FMCSC_SHAKESET</a> 3<br/>
<a href="keywords.html#SETTLEH2O">FMCSC_SETTLEH2O</a> 1<br/>
</tt>
<br/>
The third keyword above is in fact implied as a default choice (added for clarity here), and instructs CAMPARI to override
constraint choices via <a href="keywords.html#SHAKESET">FMCSC_SHAKESET</a> for all supported water
models (TIP3P, TIP4P, TIP4P-Ew, TIP5P, or SPC) in order to make them completely rigid. Here, this means that the choice via
<a href="keywords.html#SHAKESET">FMCSC_SHAKESET</a> 3 of just constraining bond lengths in water
molecules is replaced by complete rigidification. The remaining controllable parameters are left as default values.<br/>
We are now finally ready to specify the details of the realistic interaction model we plan on using.
Here, we try the <a href="references.html#ref1_18">2003 revision of the AMBER force field</a>, and can therefore paste a lot
of keywords straight from the <a href="keywords.html#AMBER">documentation</a>:<br/>
<br/>
<tt>
<a href="keywords.html#UAMODEL">FMCSC_UAMODEL</a> 0<br/>
<a href="keywords.html#INTERMODEL">FMCSC_INTERMODEL</a> 2<br/>
<a href="keywords.html#ELECMODEL">FMCSC_ELECMODEL</a> 1<br/>
<a href="keywords.html#MODE_14">FMCSC_MODE_14</a> 2<br/>
<a href="keywords.html#FUDGE_EL_14">FMCSC_FUDGE_EL_14</a> 0.833<br/>
<a href="keywords.html#FUDGE_ST_14">FMCSC_FUDGE_ST_14</a> 0.5<br/>
<a href="keywords.html#SC_ATTLJ">FMCSC_SC_ATTLJ</a> 1.0<br/>
<a href="keywords.html#EPSRULE">FMCSC_EPSRULE</a> 2<br/>
<a href="keywords.html#SIGRULE">FMCSC_SIGRULE</a> 1<br/>
<a href="keywords.html#SC_POLAR">FMCSC_SC_POLAR</a> 1.0<br/>
<a href="keywords.html#SC_BONDED_B">FMCSC_SC_BONDED_B</a> 1.0<br/>
<a href="keywords.html#SC_BONDED_A">FMCSC_SC_BONDED_A</a> 1.0<br/>
<a href="keywords.html#SC_BONDED_T">FMCSC_SC_BONDED_T</a> 1.0<br/>
<a href="keywords.html#SC_BONDED_I">FMCSC_SC_BONDED_I</a> 1.0<br/>
<a href="keywords.html#SC_EXTRA">FMCSC_SC_EXTRA</a> 0.0<br/>
<a href="keywords.html#IMPROPER_CONV">FMCSC_IMPROPER_CONV</a> 2<br/>
</tt>
<br/>
You are probably familiar with most of these terms by now (if not, click on the links). However,
the interaction model needs to be tuned to limit its range such that the simulation can be 
reasonably efficient. Part of it is the cutoff scheme we already introduced bits of.
However, truncation may be fine for true short-range interactions (inverse power potentials as in
Lennard-Jones), but is inappropriate for Coulomb interactions decaying with r<sup>-1</sup>.
In periodic systems, the infinite sum of Coulomb interactions within the "crystal" lattice
can be approximated by a grid-based numerical implementation of the Ewald decomposition of this sum,
commonly referred to as particle-mesh Ewald (PME) summation. This is what we are going to use:<br/>
<br/>
<tt>
<a href="keywords.html#LREL_MD">FMCSC_LREL_MD</a> 2<br/>
<a href="keywords.html#BSPLINE">FMCSC_BSPLINE</a> 8<br/>
<a href="keywords.html#EWFSPAC">FMCSC_EWFSPAC</a> 2.0<br/>
<a href="keywords.html#ELCUTOFF">FMCSC_ELCUTOFF</a> 10.0<br/>
</tt>
<br/>
The Fourier spacing (in &#8491;) and the order of the B-spline approximation are 
the most common tunable parameters in PME. In dynamics, <a href="keywords.html#ELCUTOFF">FMCSC_ELCUTOFF</a>
is the outer cutoff of the twin-range regime. Interactions in this regime are only recomputed
every <a href="keywords.html#NBL_UP">FMCSC_NBL_UP</a> steps. 
For the PME method, it is most appropriate to use the same values for <a href="keywords.html#ELCUTOFF">FMCSC_ELCUTOFF</a>
and <a href="keywords.html#NBCUTOFF">FMCSC_NBCUTOFF</a> due to the altered functional form. It is difficult to tune the
parameter-dependent precision of the PME method exactly although it is usually 
relatively easy to find "safe" settings (where errors when comparing to a reference
set of parameters are marginal). This tutorial will not discuss the many intricacies
of the PME method.<br/>
Lastly, our first run will be very short, and use a small time step since the structure
we use is by no means equilibrated with respect to the Hamiltonian just defined. Change existing
entries in prep.key as:<br/>
<br/>
<tt>
<a href="keywords.html#NRSTEPS">FMCSC_NRSTEPS</a> 1000<br/>
<a href="keywords.html#PDBFILE">FMCSC_PDBFILE</a> MCsoaked.pdb<br/>
</tt>
<br/>
And add or replace the following lines:<br/>
<br/>
<tt>
<a href="keywords.html#TIMESTEP">FMCSC_TIMESTEP</a> 0.00005<br/>
<a href="keywords.html#TSTAT_TAU">FMCSC_TSTAT_TAU</a> 0.0005<br/>
<a href="keywords.html#NBL_UP">FMCSC_NBL_UP</a> 1<br/>
<a href="keywords.html#CHECKFREQ">FMCSC_CHECKFREQ</a> 100<br/>
</tt>
<br/>
Since the system is poorly equilibrated, we choose a very small time step
(0.05fs) and a very short coupling time to the thermostat (0.5fs) along with
neighbor list updates at every step. This will make the integration of 
equations of motion rather slow but is necessary to prevent the simulation
from "blowing up" due to integrator instability. We can now run CAMPARI for the third time:<br/>
<br/>
<tt>
campari -k prep.key &gt;&amp; log3<br/>
</tt>
<br/>
This may take a while. Once complete, rename "PREP_END.pdb" one last time, this time to
"equil.pdb". Note that there are several reasons why CAMPARI will not provide you
with the raw speed that other software packages may. This will still be apparent 
in the actual production run that we move on to now.<br/>
<br/><big style="font-style: italic; text-decoration: underline;">Step 4 - Run the actual simulation and inspect the results</big><br/>
<br/>
For the production run, we will adjust settings so that the simulation runs more efficiently. Change existing
keywords as follows:<br/>
<br/>
<tt>
<a href="keywords.html#TIMESTEP">FMCSC_TIMESTEP</a> 0.002<br/>
<a href="keywords.html#TSTAT_TAU">FMCSC_TSTAT_TAU</a> 0.2<br/>
<a href="keywords.html#NBL_UP">FMCSC_NBL_UP</a> 5<br/>
<a href="keywords.html#NRSTEPS">FMCSC_NRSTEPS</a> 250000<br/>
<a href="keywords.html#EQUIL">FMCSC_EQUIL</a> 50000<br/>
<a href="keywords.html#PDBFILE">FMCSC_PDBFILE</a> equil.pdb<br/>
</tt>
<br/>
We will simulate for 250000 steps (500ps), with the first 100ps being discarded as equilibration.
We have increased the update frequency for the neighbor list and adjusted time step and
coupling constant of the thermostat. Note that in CAMPARI, the effective cutoff is almost
always effectively larger than what is specified via the corresponding keywords. This is 
because neighbor relationships in CAMPARI are residue-based, not atom-based. This is both 
a nuisance (computationally more expensive) and necessary (Coulombic interactions should
always be cut off in a group-consistent fashion). Of course, there are other protocols
that can ensure the latter condition in a different manner. The only exception to this 
silent bloating of cutoffs are interactions that explicitly decay to zero at a given cutoff 
value such as the <a href="keywords.html#LREL_MD">reaction-field methods</a> for dealing
with long-range electrostatics.<br/>
The only missing thing now are analysis specifications. The time needed per step is pretty high
for this simulation, so we do not expect analyses to become computationally limiting, and will therefore
leave most things on default settings. This implies that a fair amount of output will be produced
that you are encouraged to look at, but that will not be discussed at all here:<br/>
<br/>
<tt>
<a href="keywords.html#XYZOUT">FMCSC_XYZOUT</a> 100<br/>
<a href="keywords.html#XYZMODE">FMCSC_XYZMODE</a> 2<br/>
<a href="keywords.html#XYZPDB">FMCSC_XYZPDB</a> 3<br/>
<a href="keywords.html#TOROUT">FMCSC_TOROUT</a> 100<br/>
<a href="keywords.html#INTCALC">FMCSC_INTCALC</a> 50<br/>
</tt>
<br/>
Now execute:<br/>
<br/>
<tt>
campari -k prep.key &gt;&amp; log4<br/>
</tt>
<br/>
This will take quite some time to complete (probably around 2-3 days or so). It is possible that
the simulation crashes very early on, and this may indicate that the structure in "equil.pdb" still carries
some minor clashes that compromise integrator stability. In such a case, it should be possible and
straightforward to simply repeat the above minimization starting from "equil.pdb" and to then,
after successful completion, rename "PREP_END.pdb" as equil.pdb. It may also indicate that the input geometry
of the DNA was altered due to bond angle or length violations. In this latter case, it may be required to 
increase the tolerance thresholds for this with the help of keywords <a href="keywords.html#PDB_TOLERANCE_B">FMCSC_PDB_TOLERANCE_B</a>
and <a href="keywords.html#PDB_TOLERANCE_A">FMCSC_PDB_TOLERANCE_A</a>. All of the above issues can be diagnosed
with the help of the initial output in "log4".<br/>
After the production simulation has finished, check the final output in "log4" to make sure everything went fine
(look at the reported average temperature and so forth). After that, it is probably most informative to first use
<a href="references.html#ref23_9">VMD</a> to have a look at the trajectory data:<br/>
<br/>
<tt>
vmd -e PREP_VIS.vmd<br/>
</tt>
<br/>
This should typically load the trajectory (irrespective of format) and create some common
graphical representations. At first sight, you will mostly see water, but - assuming a certain
familiarity with VMD - it should be straightforward to make the water invisible or to just visualize
the solvent layer around DNA. Further things to try:<br/>
<ul>
<li>Try to determine and plot RMSD of DNA over time (several ways)</li>
<li>Try to obtain ion-ion and ion-DNA pair <a href="keywords.html#PCCALC">site-site correlation functions</a>
using the <a href="keywords.html#PDBANALYZE"> trajectory analysis</a> feature of CAMPARI</li>
<li>Analyze sugar pucker distributions and (if applicable) isomerization frequencies using the output in
<a href="outputfiles.html#FYC.dat">FYC.dat</a> that was created on-the-fly.</li>
</ul>
This ends this tutorial. We wish to reiterate that this is a bad example of actual
simulation work since no scientific question is posed upfront. It will almost always be
difficult to follow this type of inverted, <i>a posteriori</i> work flow. The simulation presented here, for example,
is unable to make accurate and quantitative predictions about ion-DNA distribution functions (box
too small, too short), about B-DNA stability (orders of magnitude too short), or non-classical base stacking
interactions (not even part of the force field). Other tutorials (such as <a href="tutorial3.html">#3</a>
or <a href="tutorial7.html">#7</a>) are much better examples in this regard.<br/>
<br/>
</div>
                    
                </div>
                </div>
                </div>
                
            <!-- Side Navigation Bar -->
            <!--<div class="art-sidebar1">-->                                    
                <!-- Contributors Block -->
                <!--<div class="art-Block">
                    <div class="art-Block-tl"></div>
                    <div class="art-Block-tr"></div>
                    <div class="art-Block-bl"></div>
                    <div class="art-Block-br"></div>
                    <div class="art-Block-tc"></div>
                    <div class="art-Block-bc"></div>
                    <div class="art-Block-cl"></div>
                    <div class="art-Block-cr"></div>
                    <div class="art-Block-cc"></div>
                    <div class="art-Block-body">
                        <div class="art-BlockHeader">
                            <div class="l"></div>
                            <div class="r"></div>
                            <div class="art-header-tag-icon">
                                <div class="t">Contributors - Links</div>
                            </div>
                        </div><div class="art-BlockContent">
                            <div class="art-BlockContent-body">
                                <div>
                                <b>Pappu Lab</b><br />
                                Washington University in St. Louis, MO<br />
                                Website: <a href="lima.wustl.edu">lima.wustl.edu</a><br />
                                Phone: (999) 999-9999 <br/>
                                <br/>
                                <b>Andreas Vitalis</b><br />
                                Unistat de Zurich<br />
                                Website: <a href="papajohns.com">vitalis.net</a><br />
                                Phone: (111) 999-9999 <br/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>-->
                
                <!-- Search Block -->
                <!--
                <div class="art-Block">
                    <div class="art-Block-tl"></div>
                    <div class="art-Block-tr"></div>
                    <div class="art-Block-bl"></div>
                    <div class="art-Block-br"></div>
                    <div class="art-Block-tc"></div>
                    <div class="art-Block-bc"></div>
                    <div class="art-Block-cl"></div>
                    <div class="art-Block-cr"></div>
                    <div class="art-Block-cc"></div>
                    <div class="art-Block-body">
                        <div class="art-BlockHeader">
                            <div class="l"></div>
                            <div class="r"></div>
                            <div class="art-header-tag-icon">
                                <div class="t">Find Text</div>
                            </div>
                        </div><div class="art-BlockContent">
                            <div class="art-BlockContent-body">
                                <div><form method="get" id="newsletterform" action="javascript:void(0)">
                                <input type="text" value="" name="email" id="s" style="width: 95%;" />
                                <span class="art-button-wrapper">
                                    <span class="l"> </span>
                                    <span class="r"> </span>
                                    <input class="art-button" type="submit" name="search" value="Search"/>
                                </span>
                                </form></div>
                            </div>
                        </div>
                    </div>
                </div> 
                -->
                
                <!-- News/Updates Block -->
                <!--
                <div class="art-Block">
                    <div class="art-Block-tl"></div>
                    <div class="art-Block-tr"></div>
                    <div class="art-Block-bl"></div>
                    <div class="art-Block-br"></div>
                    <div class="art-Block-tc"></div>
                    <div class="art-Block-bc"></div>
                    <div class="art-Block-cl"></div>
                    <div class="art-Block-cr"></div>
                    <div class="art-Block-cc"></div>
                    <div class="art-Block-body">
                        <div class="art-BlockHeader">
                            <div class="l"></div>
                            <div class="r"></div>
                            <div class="art-header-tag-icon">
                                <div class="t">Recent News</div>
                            </div>
                        </div><div class="art-BlockContent">
                            <div class="art-BlockContent-body">
                                <div>
                                    <p><b>Jun 14, 2008</b><br/>
                                    Aliquam sit amet felis. Mauris semper, 
                                    velit semper laoreet dictum, quam 
                                    diam dictum urna, nec placerat elit 
                                    nisl in quam. Etiam augue pede, 
                                    molestie eget, rhoncus at, convallis 
                                    ut, eros. Aliquam pharetra.<br/>
                                    <a href="javascript:void(0)">Read more...</a></p>
                                                          
                                    <p><b>Aug 24, 2008</b><br/>
                                    Aliquam sit amet felis. Mauris semper, 
                                    velit semper laoreet dictum, quam 
                                    diam dictum urna, nec placerat elit 
                                    nisl in quam. Etiam augue pede, 
                                    molestie eget, rhoncus at, convallis 
                                    ut, eros. Aliquam pharetra.<br/>
                                    <a href="javascript:void(0)">Read more...</a></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> --><!-- End Sidebar -->

            </div>
        </div>
    </div> <!-- End main page contents -->

            
    <!-- Footer -->
    <div class="art-Footer">
    <div class="art-Footer-background">
    <div class="art-Footer-inner">
        <a href="#" class="art-rss-tag-icon" title="RSS"></a>
        <div class="art-Footer-text">
        <p><a href="#">Contact Us</a> | <a href="#">Terms of Use</a>
        | <a href="#">Lincense Information</a><br />
        Copyright &copy; 2010 . All Rights Reserved.</p>
        </div>
    </div>
    </div>
    </div>
    <p class="art-page-footer">XHTML and CSS valid. Powered by <a href="http://www.flashmint.com/">FlashMint</a> - flash templates provider.</p>
    <div style="text-align: center; font-size: 0.75em;">Design downloaded from <a href="http://www.freewebtemplates.com/">free website templates</a>.</div>
                
</div>
</body>
</html>
